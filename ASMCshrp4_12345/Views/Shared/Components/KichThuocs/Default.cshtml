@model IEnumerable<Kichthuoc>

@{
    var selectedSizes = Context.Request.Query["selectedSizes"].ToArray() as string[];
}

<form id="sizeFilterForm" method="get" asp-action="Index">
    <div class="bg-light p-4 mb-30">
        <div class="custom-control custom-radio d-flex align-items-center justify-content-between mb-3">
            <input type="radio" class="custom-control-input" name="selectedSizes" value="all" id="size-all" onchange="submitSizeForm('all')"
            @(selectedSizes.Contains("all") ? "checked" : "")>
            <label class="custom-control-label" for="size-all">TẤT CẢ KÍCH THƯỚC</label>
        </div>
        @foreach (var item in Model)
        {
            <div class="custom-control custom-radio d-flex align-items-center justify-content-between mb-3">
                <input type="radio" class="custom-control-input" name="selectedSizes" value="@item.MaKichThuoc" id="size-@item.MaKichThuoc" onchange="submitSizeForm('specific')"
                @(selectedSizes.Contains(item.MaKichThuoc.ToString()) ? "checked" : "")>
                <label class="custom-control-label" for="size-@item.MaKichThuoc">@item.TenKichThuoc</label>
            </div>
        }
    </div>
</form>

<script>
    function submitSizeForm(type) {
        const allradio = document.getElementById('size-all');
        const radioes = document.querySelectorAll('input[name="selectedSizes"]:not(#size-all)');

        if (type === 'specific') {
            // Bỏ chọn "TẤT CẢ KÍCH THƯỚC" nếu chọn kích thước cụ thể
            allradio.checked = false;
        } else if (type === 'all') {
            // Bỏ chọn tất cả các kích thước cụ thể nếu chọn "TẤT CẢ KÍCH THƯỚC"
            radioes.forEach(radio => radio.checked = false);
        }

        // Kiểm tra nếu không có radio nào được chọn, tự động chọn lại "TẤT CẢ KÍCH THƯỚC"
        let anyChecked = Array.from(radioes).some(radio => radio.checked);
        if (!anyChecked) {
            allradio.checked = true;
        }

        document.getElementById('sizeFilterForm').submit();
    }
</script>
