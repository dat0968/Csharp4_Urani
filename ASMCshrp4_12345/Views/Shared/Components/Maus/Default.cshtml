@model IEnumerable<ASMCshrp4_12345.Models.Mausac>

@{
    var selectedColors = Context.Request.Query["selectedColors"].ToString().Split(',').ToList();
}

<form id="colorFilterForm" method="get" asp-action="Index">
    <div class="bg-light p-4 mb-30">
        <div class="custom-control custom-radio d-flex align-items-center justify-content-between mb-3">
            <input type="radio" class="custom-control-input" name="selectedColors" value="all" id="color-all" onchange="submitColorForm('all')"
            @(selectedColors.Contains("all") ? "checked" : "")>
            <label class="custom-control-label" for="color-all">TẤT CẢ MÀU SẮC</label>
        </div>
        @foreach (var item in Model)
        {
            <div class="custom-control custom-radio d-flex align-items-center justify-content-between mb-3">
                <input type="radio" class="custom-control-input" name="selectedColors" value="@item.MaMau" id="color-@item.MaMau" onchange="submitColorForm('specific')"
                @(selectedColors.Contains(item.MaMau.ToString()) ? "checked" : "")>
                <label class="custom-control-label" for="color-@item.MaMau">@item.TenMau</label>
            </div>
        }
    </div>
</form>

<script>
    function submitColorForm(type) {
        const allradio = document.getElementById('color-all');
        const radioes = document.querySelectorAll('input[name="selectedColors"]:not(#color-all)');

        if (type === 'specific') {
            // Bỏ chọn "TẤT CẢ MÀU SẮC" nếu chọn một màu cụ thể
            allradio.checked = false;
        } else if (type === 'all') {
            // Bỏ chọn tất cả các màu cụ thể nếu chọn "TẤT CẢ MÀU SẮC"
            radioes.forEach(radio => radio.checked = false);
        }

        // Kiểm tra nếu không có radio nào được chọn, tự động chọn lại "TẤT CẢ MÀU SẮC"
        let anyChecked = Array.from(radioes).some(radio => radio.checked);
        if (!anyChecked) {
            allradio.checked = true;
        }

        document.getElementById('colorFilterForm').submit();
    }
</script>
